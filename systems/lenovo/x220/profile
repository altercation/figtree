#!/bin/base

# Systems/_base/base profile. Used as foundation for other _base profiles.  
# Probably best to depend on one of those (laptop, desktop, vm) rather than 
# this profile

# -----------------------------------------------------------------------------
# NETWORKING
# -----------------------------------------------------------------------------
packages netcfg rfkill wpa_supplicant wpa_actiond ifplugd wifi-select-git
config unset /etc/rc.conf INTERFACES
config unset /etc/rc.conf eth0
config unset /etc/rc.conf eth1
config set   /etc/rc.conf WIRED_INTERFACE eth0
config set   /etc/rc.conf WIRELESS_INTERFACE wlan0
networks add main home # just adds to NETWORKS in /etc/rc.conf
daemons remove network # no longer required due to netcfg
daemons add @net-auto-wired @net-auto-wireless
overlay /etc/wpa_supplicant.conf /etc/network.d/ethernet-dhcp

# -----------------------------------------------------------------------------
# POWER
# -----------------------------------------------------------------------------
packages acpi acpid acpitool pm-utils cpufrequtils thinkfan lm_sensors
daemons add @acpi sensors
modules add thinkpad_acpi acpi_cpufreq cpufreq_ondemand cpufreq_powersave
overlay /etc/acpi/handler.sh
overlay /etc/pm/power.d/cpu
overlay /etc/pm/power.d/display
overlay /etc/pm/power.d/network
overlay /etc/pm/power.d/save-state
overlay /etc/pm/power.d/sound
overlay /etc/pm/sleep.d/11netcfg
overlay /etc/pm/sleep.d/90alsa
overlay /etc/thinkfan.conf

# -----------------------------------------------------------------------------
# INPUT
# -----------------------------------------------------------------------------
packages xbindkeys
overlay /lib/udev/keymaps/lenovo-thinkpad_x220_tablet
overlay /etc/udev/rules.d/95-keymap.rules
overlay /etc/X11/xinit/xinitrc
overlay /etc/X11/xinit/Xmodmap
overlay /etc/X11/xinit/xbindkeysrc
overlay /usr/bin/rotate-screen

# -----------------------------------------------------------------------------
# SOUND
# -----------------------------------------------------------------------------
packages alsa-utils alsa-oss alsa-equalizer
daemons add @alsa
overlays /var/lib/alsa/asound.state

# -----------------------------------------------------------------------------
# DISPLAY
# -----------------------------------------------------------------------------
packages libdrm dri2proto xf86-video-intel
packages xorg-server xorg-xinit xorg-utils xorg-server-utils xf86-input-synaptics
packages mesa mesa-demos xorg-xlsfonts xdotool unclutter
overlays /etc/drirc
overlays /etc/X11/xorg.conf.d/90-monitor.conf # to fix lcd monitor dpi size

## TODO ... abstract to a function or stick in extras ##if ( ! grep -q 
'MODULES="i915"' /etc/mkinitcpio.conf ); then
##    sed -i 's/\(^MODULES\).*$/\1="i915"/' /etc/mkinitcpio.conf
##        mkinitcpio -p kernel26
##fi

# -----------------------------------------------------------------------------
# EXTRAS
# -----------------------------------------------------------------------------

